"use strict";!function(){var RESET_FILTER_VALUE="any",lastTimeout,filtersWrapper=document.querySelector(".map__filters-container"),filteredPinsCache=[],filters=[{element:filtersWrapper.querySelector("#housing-type"),active:!1,filterPins:function(rule){filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.type===rule})}},{element:filtersWrapper.querySelector("#housing-price"),active:!1,filterPins:function(rule){"low"===rule?filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.price<1e4}):"middle"===rule?filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.price>=1e4&&data.offer.price<=5e4}):"high"===rule&&(filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.price>5e4}))}},{element:filtersWrapper.querySelector("#housing-rooms"),active:!1,filterPins:function(rule){filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.rooms===Number(rule)})}},{element:filtersWrapper.querySelector("#housing-guests"),active:!1,filterPins:function(rule){filteredPinsCache=filteredPinsCache.filter(function(data){return data.offer.guests===Number(rule)})}},new FeatureFilter(filtersWrapper.querySelector("#filter-wifi")),new FeatureFilter(filtersWrapper.querySelector("#filter-dishwasher")),new FeatureFilter(filtersWrapper.querySelector("#filter-parking")),new FeatureFilter(filtersWrapper.querySelector("#filter-washer")),new FeatureFilter(filtersWrapper.querySelector("#filter-elevator")),new FeatureFilter(filtersWrapper.querySelector("#filter-conditioner"))],filterElements=filters.map(function(element){return element.element});function FeatureFilter(element){this.element=element,this.active=!1}function onfilterWrapperChange(evt){lastTimeout&&window.clearTimeout(lastTimeout),lastTimeout=window.setTimeout(function(){filterPins(evt)},500)}function filterPins(evt){evt.preventDefault();var currentFilter=evt.target,isResetFilter=currentFilter.value===RESET_FILTER_VALUE||!1===currentFilter.checked;filteredPinsCache=window.pins.cache.slice();for(var i=0;i<filters.length;i++){var isCurrentFilter=currentFilter===filters[i].element;if(isResetFilter&&isCurrentFilter){filters[i].active=!1;break}if(isCurrentFilter){filters[i].active=!0;break}}filters.forEach(function(filter){filter.active&&filter.filterPins(filter.element.value)}),window.cards.removeActive(),window.pins.remove(),window.pins.render(filteredPinsCache)}function toggleFilters(status){switch(status){case"activate":window.utils.toggleStatusOfElements(filterElements,!1);break;case"deactivate":window.utils.toggleStatusOfElements(filterElements,!0)}}FeatureFilter.prototype.filterPins=function(rule){filteredPinsCache=filteredPinsCache.filter(function(data){for(var i=0;i<data.offer.features.length&&data.offer.features[i]!==rule;i++);return data.offer.features[i]})},toggleFilters("deactivate"),filtersWrapper.addEventListener("change",onfilterWrapperChange,!0),window.filterForm={toggleFilters:toggleFilters}}();